# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –º–µ—Ç—Ä–∏–∫–∏ Network

## üìã –ü—Ä–æ–±–ª–µ–º–∞

–ú–µ—Ç—Ä–∏–∫–∞ Network –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–ª–∞—Å—å –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ, —Ö–æ—Ç—è –±—ã–ª–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å.

## üîç –ü—Ä–∏—á–∏–Ω–∞ –ø—Ä–æ–±–ª–µ–º—ã

–í API –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–æ –ø–æ–ª–µ `network_io`, –∫–æ—Ç–æ—Ä–æ–µ –æ–∂–∏–¥–∞–ª JavaScript –∫–æ–¥. –í –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –±—ã–ª–∏ —Ç–æ–ª—å–∫–æ –ø–æ–ª—è:
- `network_in_kbps` - –≤—Ö–æ–¥—è—â–∏–π —Ç—Ä–∞—Ñ–∏–∫ –≤ –∫–±–∏—Ç/—Å
- `network_out_kbps` - –∏—Å—Ö–æ–¥—è—â–∏–π —Ç—Ä–∞—Ñ–∏–∫ –≤ –∫–±–∏—Ç/—Å

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### **1. –î–æ–±–∞–≤–ª–µ–Ω–æ –≤—ã—á–∏—Å–ª—è–µ–º–æ–µ –ø–æ–ª–µ `network_io` –≤ API**

#### **–í `app/services.py` - –º–µ—Ç–æ–¥ `get_servers_with_metrics`:**
```python
"network_in_kbps": metric.network_in_kbps if metric else None,
"network_out_kbps": metric.network_out_kbps if metric else None,
"network_io": ((metric.network_in_kbps or 0) + (metric.network_out_kbps or 0)) / 1024 if metric else None,  # Convert kbps to MB/s
```

#### **–í `app/services.py` - –º–µ—Ç–æ–¥ `get_server_metrics_history`:**
```python
"network_in_kbps": m.network_in_kbps,
"network_out_kbps": m.network_out_kbps,
"network_io": ((m.network_in_kbps or 0) + (m.network_out_kbps or 0)) / 1024,  # Convert kbps to MB/s
```

#### **–í `app/services.py` - –º–µ—Ç–æ–¥ `evaluate_alerts_optimized`:**
```python
"net_in": metric.network_in_kbps,
"net_out": metric.network_out_kbps,
"network_io": ((metric.network_in_kbps or 0) + (metric.network_out_kbps or 0)) / 1024,  # Convert kbps to MB/s
```

### **2. –õ–æ–≥–∏–∫–∞ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è**

#### **–§–æ—Ä–º—É–ª–∞:**
```python
network_io = (network_in_kbps + network_out_kbps) / 1024
```

#### **–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- **–°—É–º–º–∏—Ä—É–µ–º** –≤—Ö–æ–¥—è—â–∏–π –∏ –∏—Å—Ö–æ–¥—è—â–∏–π —Ç—Ä–∞—Ñ–∏–∫
- **–î–µ–ª–∏–º –Ω–∞ 1024** –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –∏–∑ –∫–±–∏—Ç/—Å –≤ –ú–ë/—Å
- **–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º null** –∑–Ω–∞—á–µ–Ω–∏—è (–∑–∞–º–µ–Ω—è–µ–º –Ω–∞ 0)

### **3. –ï–¥–∏–Ω–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è**

#### **–í –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö:**
- `network_in_kbps` - –∫–±–∏—Ç/—Å (–∫–∏–ª–æ–±–∏—Ç—ã –≤ —Å–µ–∫—É–Ω–¥—É)
- `network_out_kbps` - –∫–±–∏—Ç/—Å (–∫–∏–ª–æ–±–∏—Ç—ã –≤ —Å–µ–∫—É–Ω–¥—É)

#### **–í –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ:**
- `network_io` - –ú–ë/—Å (–º–µ–≥–∞–±–∞–π—Ç—ã –≤ —Å–µ–∫—É–Ω–¥—É)

#### **–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è:**
- 1 –∫–±–∏—Ç/—Å = 0.125 –∫–ë/—Å = 0.000122 –ú–ë/—Å
- 1024 –∫–±–∏—Ç/—Å = 128 –∫–ë/—Å = 0.125 –ú–ë/—Å
- 8192 –∫–±–∏—Ç/—Å = 1024 –∫–ë/—Å = 1 –ú–ë/—Å

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### **–°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö:**
```python
# –í app/monitor.py
net_io_1 = psutil.net_io_counters()
await asyncio.sleep(1)
net_io_2 = psutil.net_io_counters()
in_kbps = (net_io_2.bytes_recv - net_io_1.bytes_recv) * 8 / 1024
out_kbps = (net_io_2.bytes_sent - net_io_1.bytes_sent) * 8 / 1024
```

### **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î:**
```python
# –í app/monitor.py
network_in_kbps=r["in_kbps"],
network_out_kbps=r["out_kbps"],
```

### **API –æ—Ç–≤–µ—Ç:**
```json
{
  "latest_metric": {
    "network_in_kbps": 1024.5,
    "network_out_kbps": 2048.3,
    "network_io": 3.0
  }
}
```

### **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ:**
```javascript
updateMetricBadge(document.getElementById(`network-${s.id}`), latest.network_io, ' MB/s', 'network');
```

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

### **–î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- ‚ùå **–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö** - `network_io` –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª –≤ API
- ‚ùå **JavaScript –æ—à–∏–±–∫–∏** - –ø–æ–ø—ã—Ç–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É –ø–æ–ª—é
- ‚ùå **–ü—É—Å—Ç—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è** - –æ—Ç–æ–±—Ä–∞–∂–∞–ª—Å—è —Ç–æ–ª—å–∫–æ "-"

### **–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- ‚úÖ **–ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** - `network_io` –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –∏–∑ –≤—Ö–æ–¥—è—â–µ–≥–æ –∏ –∏—Å—Ö–æ–¥—è—â–µ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞
- ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –µ–¥–∏–Ω–∏—Ü—ã** - –ú–ë/—Å –≤–º–µ—Å—Ç–æ –∫–±–∏—Ç/—Å
- ‚úÖ **–¶–≤–µ—Ç–æ–≤–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è** - —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–æ–≥–ª–∞—Å–Ω–æ –ª–æ–≥–∏–∫–µ Network –º–µ—Ç—Ä–∏–∫

## üìä –ü—Ä–∏–º–µ—Ä—ã –∑–Ω–∞—á–µ–Ω–∏–π

### **–ù–∏–∑–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (0-50 –ú–ë/—Å):**
- –í—Ö–æ–¥—è—â–∏–π: 1024 –∫–±–∏—Ç/—Å = 0.125 –ú–ë/—Å
- –ò—Å—Ö–æ–¥—è—â–∏–π: 2048 –∫–±–∏—Ç/—Å = 0.25 –ú–ë/—Å
- **–ò—Ç–æ–≥–æ**: 0.375 –ú–ë/—Å ‚Üí üü¢ –ó–µ–ª–µ–Ω—ã–π

### **–°—Ä–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (50-100 –ú–ë/—Å):**
- –í—Ö–æ–¥—è—â–∏–π: 409600 –∫–±–∏—Ç/—Å = 50 –ú–ë/—Å
- –ò—Å—Ö–æ–¥—è—â–∏–π: 409600 –∫–±–∏—Ç/—Å = 50 –ú–ë/—Å
- **–ò—Ç–æ–≥–æ**: 100 –ú–ë/—Å ‚Üí üü° –ñ–µ–ª—Ç—ã–π

### **–í—ã—Å–æ–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (>100 –ú–ë/—Å):**
- –í—Ö–æ–¥—è—â–∏–π: 819200 –∫–±–∏—Ç/—Å = 100 –ú–ë/—Å
- –ò—Å—Ö–æ–¥—è—â–∏–π: 819200 –∫–±–∏—Ç/—Å = 100 –ú–ë/—Å
- **–ò—Ç–æ–≥–æ**: 200 –ú–ë/—Å ‚Üí üü¢ –ó–µ–ª–µ–Ω—ã–π

## üìÅ –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### **`app/services.py`:**
- –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `network_io` –≤ `get_servers_with_metrics()`
- –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `network_io` –≤ `get_server_metrics_history()`
- –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `network_io` –≤ `evaluate_alerts_optimized()`

## üéâ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ü—Ä–æ–±–ª–µ–º–∞ —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –º–µ—Ç—Ä–∏–∫–∏ Network –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ—à–µ–Ω–∞:

1. ‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω–æ –≤—ã—á–∏—Å–ª—è–µ–º–æ–µ –ø–æ–ª–µ** `network_io` –≤ API
2. ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è** –∏–∑ –∫–±–∏—Ç/—Å –≤ –ú–ë/—Å
3. ‚úÖ **–û–±—Ä–∞–±–æ—Ç–∫–∞ null –∑–Ω–∞—á–µ–Ω–∏–π** –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
4. ‚úÖ **–ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å** –≤–æ –≤—Å–µ—Ö –º–µ—Ç–æ–¥–∞—Ö API

**–¢–µ–ø–µ—Ä—å –º–µ—Ç—Ä–∏–∫–∞ Network –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ!** üöÄ
