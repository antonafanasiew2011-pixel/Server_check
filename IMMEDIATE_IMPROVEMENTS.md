# Немедленные улучшения Server Check

## 🚀 Реализованные улучшения

### 1. ✅ Мониторинг температуры CPU
- **Новая метрика**: `cpu_temp` - температура процессора в градусах Цельсия
- **Поддержка**: Linux системы с доступом к датчикам температуры
- **Отображение**: В дашборде и API
- **Алерты**: Возможность создания правил для температуры CPU

### 2. ✅ Расширенные метрики системы
- **Swap использование**: `swap_percent` - процент использования swap
- **Disk I/O**: `disk_io_read` и `disk_io_write` - скорость чтения/записи диска в MB/s
- **Улучшенная точность**: Более детальный мониторинг производительности

### 3. ✅ Мониторинг сервисов
- **Проверка статуса**: Автоматическая проверка статуса системных сервисов
- **Настройка**: Поле `services_to_monitor` в конфигурации сервера (JSON массив)
- **Пример**: `["nginx", "mysql", "redis"]`
- **Результат**: Статус каждого сервиса сохраняется в метриках

### 4. ✅ Мониторинг портов
- **Проверка доступности**: Автоматическая проверка открытых портов
- **Настройка**: Поле `ports_to_monitor` в конфигурации сервера (JSON массив)
- **Пример**: `["80", "443", "3306", "6379"]`
- **Результат**: Статус каждого порта сохраняется в метриках

### 5. ✅ Группировка алертов
- **Новая модель**: `AlertGroup` для организации правил алертов
- **Управление**: Веб-интерфейс для создания и управления группами
- **Связи**: Правила алертов могут быть привязаны к группам
- **Серьезность**: Добавлены уровни серьезности (info, warning, critical)

### 6. ✅ Улучшенная система уведомлений
- **Slack интеграция**: Поддержка Slack webhooks с форматированными сообщениями
- **Discord интеграция**: Поддержка Discord webhooks с embed сообщениями
- **Настройки**: Новые переменные окружения для интеграций
- **Форматирование**: Красивые уведомления с эмодзи и цветовой кодировкой

### 7. ✅ Экспорт отчетов в PDF
- **Генерация PDF**: Автоматическая генерация отчетов в формате PDF
- **Типы отчетов**: Серверы, алерты, метрики
- **Форматирование**: Профессиональное оформление с таблицами и графиками
- **Доступ**: Через веб-интерфейс и API

## 🔧 Настройка новых функций

### Переменные окружения для уведомлений

Добавьте в `.env` файл или системные переменные:

```bash
# Slack уведомления
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK
SLACK_CHANNEL=#alerts

# Discord уведомления  
DISCORD_WEBHOOK_URL=https://discord.com/api/webhooks/YOUR/DISCORD/WEBHOOK

# Существующие настройки (обновлены)
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=your-email@gmail.com
SMTP_PASSWORD=your-app-password
SMTP_FROM=your-email@gmail.com
SMTP_USE_TLS=true

TELEGRAM_BOT_TOKEN=your-bot-token
TELEGRAM_CHAT_ID=your-chat-id

DEFAULT_WEBHOOK_URL=https://your-webhook-endpoint.com/alerts
```

### Настройка мониторинга сервисов

В форме редактирования сервера добавьте JSON массив сервисов:

```json
["nginx", "mysql", "redis", "postgresql"]
```

### Настройка мониторинга портов

В форме редактирования сервера добавьте JSON массив портов:

```json
["80", "443", "3306", "6379", "5432"]
```

## 📊 Новые возможности интерфейса

### Дашборд
- **Температура CPU**: Отображается в карточках серверов
- **Цветовая индикация**: Красный >80°C, желтый >70°C, зеленый <70°C
- **Экспорт PDF**: Кнопка для экспорта отчета по серверам

### Управление алертами
- **Группы алертов**: Новый раздел для организации правил
- **Уровни серьезности**: Info, Warning, Critical с цветовой кодировкой
- **Новые метрики**: CPU температура, Swap, Disk I/O
- **Экспорт PDF**: Отчеты по алертам и событиям

### API улучшения
- **Новые метрики**: Все новые поля доступны через API
- **Prometheus**: Обновленные метрики для экспорта
- **PDF API**: `/reports/export.pdf` с параметрами

## 🚀 Установка зависимостей

Обновите зависимости:

```bash
pip install -r requirements.txt
```

Новая зависимость:
- `reportlab` - для генерации PDF отчетов

## 🔄 Миграция базы данных

При первом запуске приложения автоматически добавятся новые поля:

- `metrics`: cpu_temp, swap_percent, disk_io_read, disk_io_write, services_status, ports_status
- `servers`: services_to_monitor, ports_to_monitor  
- `alert_rules`: group_id, severity
- `alert_groups`: новая таблица

## 📈 Мониторинг производительности

### Новые метрики Prometheus
```
server_cpu_temp{server_id="1",hostname="web1",ip="192.168.1.10"} 45.2
server_swap_percent{server_id="1",hostname="web1",ip="192.168.1.10"} 12.5
server_disk_io_read{server_id="1",hostname="web1",ip="192.168.1.10"} 15.3
server_disk_io_write{server_id="1",hostname="web1",ip="192.168.1.10"} 8.7
```

## 🎯 Следующие шаги

1. **Настройте уведомления**: Добавьте webhook URLs для Slack/Discord
2. **Создайте группы алертов**: Организуйте правила по категориям
3. **Настройте мониторинг**: Добавьте сервисы и порты для мониторинга
4. **Создайте алерты**: Используйте новые метрики для мониторинга
5. **Экспортируйте отчеты**: Генерируйте PDF отчеты для документации

## 🔍 Проверка работы

1. **Температура CPU**: Проверьте отображение в дашборде
2. **Сервисы**: Убедитесь, что статус сервисов отображается корректно
3. **Порты**: Проверьте мониторинг портов
4. **Уведомления**: Протестируйте отправку в Slack/Discord
5. **PDF экспорт**: Сгенерируйте отчеты и проверьте форматирование

Все улучшения готовы к использованию! 🎉
